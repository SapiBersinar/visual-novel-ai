/* Base Styles & Theme Variables */
body {
    font-family: 'Inter', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    padding: 1.5rem; /* Tailwind 'p-6' equivalent */
    box-sizing: border-box;
    overflow-x: hidden;
    transition: background-color 0.3s ease, color 0.3s ease;
}

/* Theme specific variables - now mapped to Tailwind-like values */
body.light-theme {
    --bg-color: #f3f4f6; /* Tailwind gray-100 */
    --container-bg: #ffffff; /* Tailwind white */
    --text-color: #1f2937; /* Tailwind gray-900 */
    --sub-text-color: #4b5563; /* Tailwind gray-700 */
    --light-text-color: #6b7280; /* Tailwind gray-500 */
    --border-color: #d1d5db; /* Tailwind gray-300 */
    --shadow-color: rgba(0, 0, 0, 0.1); /* Tailwind shadow-md default */
    --title-color: #1f2937; /* Tailwind gray-900 */
    --title-shadow-color: rgba(0, 0, 0, 0.05); /* Lighter shadow for modern feel */
    --input-bg: #f9fafb; /* Tailwind gray-50 */
    --input-border: #d1d5db; /* Tailwind gray-300 */
    --input-text: #1f2937; /* Tailwind gray-900 */
    --input-placeholder: #6b7280; /* Tailwind gray-500 */

    --btn-primary-bg: #1f2937; /* Tailwind gray-900 */
    --btn-primary-text: #ffffff;
    --btn-primary-hover-bg: #374151; /* Tailwind gray-700 */
    --btn-primary-shadow: rgba(0, 0, 0, 0.15);

    --btn-success-bg: #10b981; /* Tailwind green-500 */
    --btn-success-text: #ffffff;
    --btn-success-hover-bg: #059669; /* Tailwind green-600 */
    --btn-success-shadow: rgba(16, 185, 129, 0.2);

    --btn-secondary-bg: #e5e7eb; /* Tailwind gray-200 */
    --btn-secondary-text: #1f2937; /* Tailwind gray-900 */
    --btn-secondary-hover-bg: #d1d5db; /* Tailwind gray-300 */
    --btn-secondary-shadow: rgba(0, 0, 0, 0.08);

    --loading-spinner-color: #3b82f6; /* Tailwind blue-500 */
    --card-bg: #ffffff; /* Tailwind white */
    --card-border: #e5e7eb; /* Tailwind gray-200 */
    --card-shadow: rgba(0, 0, 0, 0.05); /* Tailwind shadow-sm */

    --dialogue-mc-bg: #eff6ff; /* Tailwind blue-50 */
    --dialogue-mc-border: #93c5fd; /* Tailwind blue-300 */
    --dialogue-mc-speaker: #1d4ed8; /* Tailwind blue-700 */

    --dialogue-other-bg: #f3f4f6; /* Tailwind gray-100 */
    --dialogue-other-border: #d1d5db; /* Tailwind gray-300 */
    --dialogue-other-speaker: #374151; /* Tailwind gray-700 */

    --choice-card-bg: #e0f2fe; /* Tailwind light blue */
    --choice-card-border: #38bdf8; /* Tailwind sky-400 */
    --choice-card-shadow: rgba(56, 189, 248, 0.2);

    --system-display-bg: #f9fafb; /* Tailwind gray-50 */
    --system-display-border: #e5e7eb; /* Tailwind gray-200 */
    --system-title-color: #1f2937; /* Tailwind gray-900 */

    --positive-color: #10b981; /* Tailwind green-500 */
    --negative-color: #ef4444; /* Tailwind red-500 */
    --neutral-color: #f59e0b; /* Tailwind amber-500 */
}

body.dark-theme {
    --bg-color: #111827; /* Tailwind gray-900 */
    --container-bg: #1f2937; /* Tailwind gray-800 */
    --text-color: #e5e7eb; /* Tailwind gray-200 */
    --sub-text-color: #9ca3af; /* Tailwind gray-400 */
    --light-text-color: #6b7280; /* Tailwind gray-500 */
    --border-color: #4b5563; /* Tailwind gray-600 */
    --shadow-color: rgba(0, 0, 0, 0.4);
    --title-color: #f9fafb; /* Tailwind gray-50 */
    --title-shadow-color: rgba(255, 255, 255, 0.05);

    --input-bg: #374151; /* Tailwind gray-700 */
    --input-border: #4b5563; /* Tailwind gray-600 */
    --input-text: #e5e7eb; /* Tailwind gray-200 */
    --input-placeholder: #9ca3af; /* Tailwind gray-400 */

    --btn-primary-bg: #6b7280; /* Tailwind gray-500 */
    --btn-primary-text: #ffffff;
    --btn-primary-hover-bg: #4b5563; /* Tailwind gray-700 */
    --btn-primary-shadow: rgba(0, 0, 0, 0.3);

    --btn-success-bg: #059669; /* Tailwind green-600 */
    --btn-success-text: #ffffff;
    --btn-success-hover-bg: #047857; /* Tailwind green-700 */
    --btn-success-shadow: rgba(5, 150, 105, 0.3);

    --btn-secondary-bg: #374151; /* Tailwind gray-700 */
    --btn-secondary-text: #e5e7eb; /* Tailwind gray-200 */
    --btn-secondary-hover-bg: #4b5563; /* Tailwind gray-600 */
    --btn-secondary-shadow: rgba(0, 0, 0, 0.2);

    --loading-spinner-color: #60a5fa; /* Tailwind blue-400 */
    --card-bg: #1f2937; /* Tailwind gray-800 */
    --card-border: #374151; /* Tailwind gray-700 */
    --card-shadow: rgba(0, 0, 0, 0.2);

    --dialogue-mc-bg: #1e3a8a; /* Tailwind blue-900 */
    --dialogue-mc-border: #3b82f6; /* Tailwind blue-500 */
    --dialogue-mc-speaker: #93c5fd; /* Tailwind blue-300 */

    --dialogue-other-bg: #2d3748; /* Darker gray for others */
    --dialogue-other-border: #4a5568; /* Even darker gray */
    --dialogue-other-speaker: #cbd5e0; /* Lighter gray */

    --choice-card-bg: #1e40af; /* Tailwind blue-800 */
    --choice-card-border: #3b82f6; /* Tailwind blue-500 */
    --choice-card-shadow: rgba(59, 130, 246, 0.3);

    --system-display-bg: #1f2937; /* Tailwind gray-800 */
    --system-display-border: #4b5563; /* Tailwind gray-600 */
    --system-title-color: #e5e7eb; /* Tailwind gray-200 */

    --positive-color: #34d399; /* Tailwind green-400 */
    --negative-color: #f87171; /* Tailwind red-400 */
    --neutral-color: #fbbf24; /* Tailwind amber-400 */
}

body.eye-protection-theme {
    --bg-color: #fdf5e6; /* Creamy background */
    --container-bg: #fff8e1; /* Lighter cream container */
    --text-color: #5c4033; /* Dark brown text */
    --sub-text-color: #8b7967; /* Muted brown */
    --light-text-color: #a08060; /* Lighter brown */
    --border-color: #7a5f4c;
    --shadow-color: rgba(122, 95, 76, 0.2);
    --title-color: #4a342a;
    --title-shadow-color: rgba(74, 52, 42, 0.05);

    --input-bg: #fffbf5;
    --input-border: #9a7f6c;
    --input-text: #5c4033;
    --input-placeholder: #b0a090;

    --btn-primary-bg: #7a5f4c;
    --btn-primary-text: #fff8e1;
    --btn-primary-hover-bg: #9a7f6c;
    --btn-primary-shadow: rgba(122, 95, 76, 0.25);

    --btn-success-bg: #5c8b5c; /* Muted green */
    --btn-success-text: #ffffff;
    --btn-success-hover-bg: #4a754a;
    --btn-success-shadow: rgba(92, 139, 92, 0.25);

    --btn-secondary-bg: #e0d0b0;
    --btn-secondary-text: #5c4033;
    --btn-secondary-hover-bg: #c0b090;
    --btn-secondary-shadow: rgba(0, 0, 0, 0.1);

    --loading-spinner-color: #8b7967;
    --card-bg: #fff8e1;
    --card-border: #e0d0b0;
    --card-shadow: rgba(122, 95, 76, 0.1);

    --dialogue-mc-bg: #e6d7bb;
    --dialogue-mc-border: #c0b090;
    --dialogue-mc-speaker: #7a5f4c;

    --dialogue-other-bg: #f0ebd4;
    --dialogue-other-border: #d0c0a0;
    --dialogue-other-speaker: #8b7967;

    --choice-card-bg: #e1f0e1;
    --choice-card-border: #a1bca1;
    --choice-card-shadow: rgba(161, 188, 161, 0.2);

    --system-display-bg: #fdf5e6;
    --system-display-border: #e0d0b0;
    --system-title-color: #5c4033;

    --positive-color: #4a7e32;
    --negative-color: #b35f5f;
    --neutral-color: #cc9900;
}

/* Apply theme variables to core elements */
body {
    background-color: var(--bg-color);
    color: var(--text-color);
}

/* Main Container - Adjusted to Tailwind classes */
.main-container {
    background-color: var(--container-bg);
    border-color: var(--border-color);
    box-shadow: 0 10px 15px -3px var(--shadow-color), 0 4px 6px -2px var(--shadow-color); /* Shadow-xl like */
    transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
}

/* Screen Base Class */
.screen {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%; /* Ensures it takes full width within container */
}

/* Titles */
h1 {
    color: var(--title-color);
    text-shadow: 2px 2px 0px var(--title-shadow-color); /* Subtle text shadow */
    transition: color 0.3s ease, text-shadow 0.3s ease;
}

h2 {
    color: var(--text-color);
    text-shadow: 1px 1px 0px var(--title-shadow-color); /* Subtle text shadow */
    transition: color 0.3s ease, text-shadow 0.3s ease;
}

/* Form Elements (Inputs, Textareas, Selects) */
.form-input, .form-select {
    border: 1px solid var(--input-border);
    background-color: var(--input-bg);
    color: var(--input-text);
    transition: all 0.2s ease-in-out;
}

.form-input::placeholder,
textarea::placeholder {
    color: var(--input-placeholder);
}

.form-input:focus,
.form-select:focus {
    border-color: var(--btn-primary-bg); /* Use primary button color for focus */
    outline: none; /* Remove default outline */
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3); /* Ring focus style */
}

/* Custom arrow for select */
.form-select {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    background-image: url('data:image/svg+xml;utf8,<svg fill="%236b7280" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'); /* Tailwind gray-500 for arrow */
    background-repeat: no-repeat;
    background-position: right 1rem center; /* Adjusted for larger padding */
    padding-right: 2.5rem; /* Space for custom arrow */
}

/* Buttons */
.btn {
    border: 1px solid var(--btn-primary-bg); /* Default border from primary */
    transition: all 0.2s ease-in-out;
    position: relative;
    overflow: hidden;
}

.btn-primary {
    background-color: var(--btn-primary-bg);
    color: var(--btn-primary-text);
    box-shadow: 0 4px 6px -1px var(--btn-primary-shadow), 0 2px 4px -2px var(--btn-primary-shadow); /* Tailwind shadow-md like */
    border-color: var(--btn-primary-bg);
}
.btn-primary:hover {
    background-color: var(--btn-primary-hover-bg);
    box-shadow: 0 10px 15px -3px var(--btn-primary-shadow), 0 4px 6px -4px var(--btn-primary-shadow); /* Tailwind shadow-lg like */
    transform: translateY(-2px);
}

.btn-success {
    background-color: var(--btn-success-bg);
    color: var(--btn-success-text);
    box-shadow: 0 4px 6px -1px var(--btn-success-shadow), 0 2px 4px -2px var(--btn-success-shadow);
    border-color: var(--btn-success-bg);
}
.btn-success:hover {
    background-color: var(--btn-success-hover-bg);
    box-shadow: 0 10px 15px -3px var(--btn-success-shadow), 0 4px 6px -4px var(--btn-success-shadow);
    transform: translateY(-2px);
}

.btn-secondary {
    background-color: var(--btn-secondary-bg);
    color: var(--btn-secondary-text);
    box-shadow: 0 4px 6px -1px var(--btn-secondary-shadow), 0 2px 4px -2px var(--btn-secondary-shadow);
    border-color: var(--btn-secondary-bg);
}
.btn-secondary:hover {
    background-color: var(--btn-secondary-hover-bg);
    box-shadow: 0 10px 15px -3px var(--btn-secondary-shadow), 0 4px 6px -4px var(--btn-secondary-shadow);
    transform: translateY(-2px);
}

/* Radio Group */
.radio-group label {
    color: var(--sub-text-color);
}
.radio-group input[type="radio"] {
    border-color: var(--input-border);
    background-color: var(--input-bg);
}
.radio-group input[type="radio"]::before {
    box-shadow: inset 1em 1em var(--btn-primary-bg); /* Use primary button color for checked state */
}

/* Loading Indicator & Spinner */
.loading-indicator {
    color: var(--sub-text-color);
    /* For loading-ai and loading-characters, these properties are set */
    /* display: flex; flex-direction: column; align-items: center; justify-content: center; */
}
.loading-indicator .spinner {
    border: 4px solid var(--input-border); /* Use input border for base */
    border-top: 4px solid var(--loading-spinner-color); /* Spinner color */
}
.loading-indicator span { /* Applies to loading-text and loading-additional-text */
    color: var(--sub-text-color);
}
.loading-indicator #loading-additional-text {
    color: var(--light-text-color);
}


/* New Loading Card Style (for game-loading-overlay) */
.loading-card {
    /* Uses Tailwind classes in HTML: w-full max-w-sm mx-auto p-8 rounded-2xl shadow-xl border-2 border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 flex flex-col items-center justify-center text-center z-50 */
    background-color: var(--container-bg);
    border-color: var(--border-color);
    box-shadow: 0 10px 15px -3px var(--shadow-color), 0 4px 6px -2px var(--shadow-color);
    /* Position the loading overlay in the center */
    position: fixed; /* Use fixed to center relative to viewport */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%); /* Center element precisely */
    width: 90%; /* Ensure responsiveness */
    max-width: 400px; /* Limit max width */
    z-index: 100; /* Ensure it's above other game elements */
    background-color: rgba(var(--container-bg-rgb, 255, 255, 255), 0.9); /* Use RGB and alpha for semi-transparency */
    backdrop-filter: blur(5px); /* Optional: blur background */
    -webkit-backdrop-filter: blur(5px); /* For Safari */
}

/* Fallback for --container-bg-rgb for older browsers or if variable is not set */
body.light-theme .loading-card {
    background-color: rgba(255, 255, 255, 0.9);
}
body.dark-theme .loading-card {
    background-color: rgba(31, 41, 55, 0.9);
}
body.eye-protection-theme .loading-card {
    background-color: rgba(255, 248, 225, 0.9);
}


.loading-card .spinner {
    border: 4px solid var(--input-border);
    border-top: 4px solid var(--loading-spinner-color);
}
.loading-card span { /* For text inside loading-card */
    color: var(--sub-text-color);
}


/* Card Styles (Story, Character, Summary sections) */
.story-card, .character-card, .summary-card {
    background-color: var(--card-bg);
    border: 1px solid var(--card-border);
    box-shadow: 0 1px 3px 0 var(--card-shadow), 0 1px 2px 0 var(--card-shadow); /* Tailwind shadow-sm */
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out, border-color 0.2s ease-in-out, background-color 0.3s ease;
}
.story-card:hover, .character-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 6px -1px var(--card-shadow), 0 2px 4px -2px var(--card-shadow); /* Tailwind shadow-md */
}
.story-card.selected {
    border-color: var(--btn-primary-bg);
    box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.3), 0 4px 6px -4px rgba(59, 130, 246, 0.3); /* Blue shadow for selection */
}

/* Selected Character Card */
.character-card.selected-mc {
    border-color: var(--btn-success-bg); /* Green border for selected MC */
    background-color: var(--dialogue-mc-bg); /* Light background for selected MC */
    box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.3), 0 4px 6px -4px rgba(16, 185, 129, 0.3); /* Green shadow */
}
.character-card h2 {
    color: var(--text-color);
}
.character-card p {
    color: var(--sub-text-color);
}
.char-detail {
    color: var(--text-color); /* Ensure detail labels are prominent */
}

/* Custom Message Box */
.message-box { /* The overlay background */
    background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent black */
}
.message-box-content {
    background-color: var(--container-bg);
    border-color: var(--border-color);
    box-shadow: 0 20px 25px -5px var(--shadow-color), 0 10px 10px -5px var(--shadow-color); /* Tailwind shadow-2xl like */
}
.message-box-content h3 {
    color: var(--title-color);
}
.message-box-content p {
    color: var(--sub-text-color);
}

/* Game Play Specific Styles */
#game-play-screen {
    background-color: var(--container-bg);
    border: 1px solid var(--card-border);
    box-shadow: 0 4px 6px -1px var(--card-shadow), 0 2px 4px -2px var(--card-shadow); /* Tailwind shadow-md like */
}

/* Chapter Header Card */
.chapter-header-card {
    background-color: var(--card-bg);
    border: 1px solid var(--card-border);
    box-shadow: 0 1px 3px 0 var(--card-shadow), 0 1px 2px 0 var(--card-shadow);
    color: var(--text-color);
    transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
}
.chapter-header-card h2 {
    color: var(--title-color);
    text-shadow: none; /* Remove text-shadow for cleaner look in card */
}
.chapter-header-card .chapter-meta {
    color: var(--sub-text-color);
}

/* Narrative and Dialogue Content */
.narrative-content p {
    color: var(--text-color);
}
.narrative-content .prolog-quote, .narrative-content .chapter-quote {
    color: var(--sub-text-color);
    border-left: 4px solid var(--card-border);
}

/* Dialogue Cards */
.character-dialogue-card {
    border: 1px solid var(--card-border);
    box-shadow: 0 1px 2px 0 var(--card-shadow);
    color: var(--text-color);
}
.mc-dialogue-card {
    background-color: var(--dialogue-mc-bg);
    border-color: var(--dialogue-mc-border);
}
.mc-dialogue-card strong.speaker-name {
    color: var(--dialogue-mc-speaker);
}
.other-dialogue-card {
    background-color: var(--dialogue-other-bg);
    border-color: var(--dialogue-other-border);
}
.other-dialogue-card strong.speaker-name {
    color: var(--dialogue-other-speaker);
}

/* Dynamic Systems Display */
#dynamic-systems-display {
    background-color: var(--system-display-bg);
    border: 1px dashed var(--system-display-border);
}
#dynamic-systems-display h3 {
    color: var(--system-title-color);
}
#dynamic-systems-display p {
    color: var(--sub-text-color);
}
#dynamic-systems-display .system-title {
    color: var(--system-title-color);
}
.trust-update-item, .dna-item, .achievement-item, .flag-item, .time-event-item {
    border-bottom: 1px dotted var(--system-display-border);
    color: var(--sub-text-color);
}
.trust-update-item .positive { color: var(--positive-color); }
.trust-update-item .negative { color: var(--negative-color); }
.trust-update-item .neutral { color: var(--neutral-color); }

/* Choice Cards */
.choice-card {
    background-color: var(--choice-card-bg);
    border: 1px solid var(--choice-card-border);
    box-shadow: 0 2px 4px -1px var(--choice-card-shadow);
    color: var(--text-color);
}
.choice-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px -1px var(--choice-card-shadow);
    background-color: var(--choice-card-bg); /* Keep base color, let shadow change */
}
.choice-card .choice-emote {
    color: var(--text-color); /* Ensure emote color is consistent */
}

/* Theme Toggle Button */
.theme-toggle-button {
    background-color: var(--btn-secondary-bg);
    color: var(--btn-secondary-text);
    border: 1px solid var(--btn-secondary-bg); /* Match button bg for border */
    box-shadow: 0 4px 6px -1px var(--btn-secondary-shadow);
}
.theme-toggle-button:hover {
    background-color: var(--btn-secondary-hover-bg);
    box-shadow: 0 10px 15px -3px var(--btn-secondary-shadow);
}

/* Animated Title */
.animated-title {
    animation: bounceIn 1s ease-out;
}

@keyframes bounceIn {
    0% {
        opacity: 0;
        transform: scale(0.8) translateY(-20px);
    }
    50% {
        opacity: 1;
        transform: scale(1.05) translateY(5px);
    }
    70% {
        transform: scale(0.98) translateY(-2px);
    }
    100% {
        transform: scale(1) translateY(0);
    }
}

/* Responsive adjustments for small screens (Tailwind's 'sm' breakpoint is 640px) */
@media (max-width: 639px) {
    body {
        padding: 1rem; /* p-4 */
    }
    .main-container {
        padding: 1.5rem; /* p-6 */
        border-radius: 1rem; /* rounded-xl */
    }
    h1 {
        font-size: 2.5rem; /* sm:text-4xl */
    }
    h2 {
        font-size: 1.5rem; /* sm:text-2xl */
    }
    .form-input, .form-select, .btn {
        padding: 0.75rem 1rem; /* py-3 px-4 */
        font-size: 1rem; /* text-base */
    }
    .radio-group {
        flex-direction: column;
        gap: 1rem;
    }
    .loading-indicator span {
        font-size: 1.125rem; /* text-lg */
    }
    .loading-indicator .spinner {
        width: 2.5rem; /* w-10 */
        height: 2.5rem; /* h-10 */
        border-width: 4px;
    }
    .story-card p, .character-card p, .summary-card p, .character-dialogue-card span {
        font-size: 0.875rem; /* text-sm */
    }
    .message-box-content {
        padding: 1.5rem; /* p-6 */
    }
    .theme-toggle-button {
        top: 1rem;
        left: 1rem;
        padding: 0.5rem 0.75rem; /* p-2 px-3 */
        font-size: 0.875rem; /* text-sm */
    }
    #theme-toggle-text {
        display: none; /* Hide text on small screens */
    }

    /* Adjustments for loading-card on small screens if needed */
    .loading-card {
        max-width: 90%; /* Adjust max-width for smaller screens */
    }
}

